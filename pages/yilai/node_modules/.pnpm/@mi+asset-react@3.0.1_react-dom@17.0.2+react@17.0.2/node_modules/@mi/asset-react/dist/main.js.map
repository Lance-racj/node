{"version":3,"sources":["../src/main.ts","../src/AssetImage.tsx","../src/use-resize-observer.ts","../../shared/lib/calc.ts","../../shared/lib/const.ts","../../shared/lib/style.ts","../../shared/lib/utils.ts","../src/use-intersection-observer.ts","../src/use-props.ts","../src/ConfigProvider.tsx","../src/use-image-url-generator.ts","../src/use-debounce-func.tsx"],"sourcesContent":["export * from \"./AssetImage\";\nexport * from \"./ConfigProvider\";\nexport * from \"./use-image-url-generator\";\n","import React, { ReactEventHandler, useRef, useState } from \"react\";\n\nimport { ConfigProviderProps } from \"./ConfigProvider\";\nimport useResizeObserver from \"./use-resize-observer\";\nimport {\n  getAspectRatio,\n  getObjectFitWidth,\n  generateContainerStyle,\n  generatePlaceholderStyle,\n  generateImageStyle,\n  TRANSITION_TIME_FUNCTION,\n  TRANSITION_DURATION,\n  getWindowAspectRatio,\n} from \"../../shared\";\nimport useIntersectionObserver from \"./use-intersection-observer\";\nimport { useProps } from \"./use-props\";\nimport { useImageUrlGenerator } from \"./use-image-url-generator\";\nimport { useDebounceFunction } from \"./use-debounce-func\";\n\nexport interface AssetImageProps extends ConfigProviderProps {\n  path: string;\n  width: number;\n  height: number;\n  layout: \"fixed\" | \"intrinsic\" | \"responsive\" | \"fill\";\n  format?: string;\n  alt?: string;\n}\n\nexport const AssetImage: React.FunctionComponent<AssetImageProps> = (\n  componentProps\n) => {\n  const props = useProps(componentProps);\n  const generateImageUrl = useImageUrlGenerator();\n\n  // 容器元素 ref\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // 是否将图片添加至文档流中，用于懒加载逻辑\n  const [shouldLoadImage, setShouldLoadImage] = useState(!props.lazy);\n\n  // 是否显示图片\n  const [showImage, setShowImage] = useState(false);\n\n  // 计算得到的图片尺寸\n  const [computedWidth, setComputedWidth] = useState(0);\n  const setComputedWidthDebounce = useDebounceFunction(\n    setComputedWidth,\n    300,\n    true\n  );\n\n  // 占位图是否出现在文档流中, 用于移除占位图\n  const [shouldLoadPlaceholder, setShouldLoadPlaceholder] = useState(\n    !!props.placeholder\n  );\n  const setShouldLoadPlaceholderDebounce = useDebounceFunction(\n    setShouldLoadPlaceholder,\n    TRANSITION_DURATION\n  );\n\n  // 是否需要占位元素，占位元素决定了容器的宽高，仅当需要固定宽高比时需要\n  const isNeedPlaceholderElement =\n    props.layout === \"fixed\" ||\n    props.layout === \"intrinsic\" ||\n    props.layout === \"responsive\";\n\n  // 图片加载完成后触发\n  const onImageLoad: ReactEventHandler<HTMLImageElement> = () => {\n    setShowImage(true);\n    if (shouldLoadPlaceholder) {\n      setShouldLoadPlaceholderDebounce(false);\n    }\n  };\n\n  // 懒加载\n  useIntersectionObserver(containerRef, (entry, observer) => {\n    if (entry.isIntersecting) {\n      setShouldLoadImage(true);\n      observer.unobserve(entry.target);\n    }\n  });\n\n  useResizeObserver(containerRef, (entry) => {\n    const { width, height, sizeStep, layout, objectFit } = props;\n    const rectWidth = entry.contentRect.width;\n    const rectHeight = entry.contentRect.height;\n\n    // 当 layout 为 fill 时，需要根据定位方法计算图片的真实宽度\n    const imageWidth =\n      layout === \"fill\"\n        ? getObjectFitWidth(rectWidth, rectHeight, width, height, objectFit)\n        : rectWidth;\n\n    // 忽略元素宽度为 0 的情况\n    if (rectWidth && sizeStep && sizeStep > 0) {\n      const newWidth = Math.min(\n        width,\n        Math.ceil((imageWidth * getWindowAspectRatio()) / sizeStep) * sizeStep\n      );\n      if (newWidth !== computedWidth) {\n        setComputedWidthDebounce(newWidth);\n      }\n    }\n  });\n\n  // 容器样式\n  const containerStyle = generateContainerStyle(\n    props.layout,\n    props.width,\n    props.height,\n    props.backgroundColor,\n    props.style\n  );\n\n  // 占位图样式\n  const placeholderImageStyle = generatePlaceholderStyle(\n    props.objectFit,\n    props.objectPosition,\n    {\n      opacity: showImage ? 0 : 1,\n      transition: props.animation\n        ? `opacity ${TRANSITION_DURATION}ms ${TRANSITION_TIME_FUNCTION}`\n        : \"\",\n    }\n  );\n\n  // 图片样式\n  const imageStyle = generateImageStyle(props.objectFit, props.objectPosition, {\n    ...props.imageStyle,\n    // 仅当为设置占位图时，直接给图片设置渐变\n    ...(!props.placeholder &&\n      props.animation && {\n        opacity: showImage ? 1 : 0,\n        transition: `opacity ${TRANSITION_DURATION}ms ${TRANSITION_TIME_FUNCTION}`,\n      }),\n  });\n\n  return (\n    <div style={containerStyle} className={props.className} ref={containerRef}>\n      {\n        /* 占位元素，撑开高度 */\n        isNeedPlaceholderElement && (\n          <div\n            style={{\n              paddingTop: getAspectRatio(props.width, props.height) * 100 + \"%\",\n            }}\n          ></div>\n        )\n      }\n\n      {shouldLoadImage && computedWidth && generateImageUrl && (\n        <img\n          style={imageStyle}\n          className={props.imageClassName}\n          alt={props.alt}\n          src={generateImageUrl(props.path, {\n            width: computedWidth,\n            quality: props.quality,\n            format: props.format,\n            secret: props.secretToken,\n          })}\n          onLoad={onImageLoad}\n          decoding=\"async\"\n        ></img>\n      )}\n\n      {\n        /* 占位图 */\n        shouldLoadPlaceholder && (\n          <img src={props.placeholder} style={placeholderImageStyle}></img>\n        )\n      }\n    </div>\n  );\n};\n","import { RefObject, useEffect } from \"react\";\nimport ResizeObserver from \"resize-observer-polyfill\";\n\ntype ElementRef = RefObject<Element>;\ntype CallbackFunction = (\n  entry: ResizeObserverEntry,\n  observer: ResizeObserver\n) => void;\n\ndeclare global {\n  interface Element {\n    _resizeHandler?: CallbackFunction;\n  }\n}\n\nlet observer: ResizeObserver | null = null;\n\nexport default function useResizeObserver(\n  elementRef: ElementRef,\n  callback: CallbackFunction\n) {\n  useEffect(() => {\n    if (!observer) {\n      observer = new ResizeObserver(\n        (entries: ResizeObserverEntry[], observer: ResizeObserver) => {\n          entries.forEach((entry) => {\n            entry.target._resizeHandler?.(entry, observer);\n          });\n        }\n      );\n    }\n\n    if (observer && elementRef.current) {\n      elementRef.current._resizeHandler = callback;\n      observer.observe(elementRef.current);\n    }\n\n    return () => {\n      if (observer && elementRef.current) {\n        observer.unobserve(elementRef.current);\n      }\n    };\n  }, []);\n}\n","export function getWindowAspectRatio() {\n  // 考虑到性能问题，最大为3倍\n  return Math.min(3, window.devicePixelRatio || 1);\n}\n\nexport function getAspectRatio(width: number, height: number) {\n  if (!height || !width) {\n    throw new Error(\"You must provide height and width.\");\n  }\n  const aspectRatio = height / width;\n  if (isNaN(aspectRatio)) {\n    throw new Error(\"Invalid width or height\");\n  }\n  return aspectRatio;\n}\n\nexport function getObjectFitWidth(\n  containerWidth: number,\n  containerHeight: number,\n  imageWidth: number,\n  imageHeight: number,\n  objectFit?: string\n) {\n  const naturalRatio = imageWidth / imageHeight;\n  const visibleRatio = containerWidth / containerHeight;\n\n  if (objectFit === \"none\") {\n    return imageWidth;\n  }\n\n  if (objectFit === \"contain\" || objectFit === \"scale-down\") {\n    const objectFitWidth =\n      naturalRatio > visibleRatio\n        ? containerWidth\n        : (containerHeight / imageHeight) * imageWidth;\n\n    return objectFit === \"contain\"\n      ? objectFitWidth\n      : Math.min(imageWidth / objectFitWidth);\n  }\n\n  if (objectFit === \"cover\") {\n    return naturalRatio > visibleRatio\n      ? containerHeight * naturalRatio\n      : containerWidth;\n  }\n\n  return containerWidth;\n}\n","export const PLACEHOLDER_BLURRED = 5;\nexport const TRANSITION_TIME_FUNCTION = \"cubic-bezier(0.25, 0.46, 0.45, 0.94)\";\nexport const TRANSITION_DURATION = 330;\n","import { PLACEHOLDER_BLURRED } from \"./const\";\n\nconst insetStyle = {\n  top: 0,\n  height: \"100%\",\n  left: 0,\n  width: \"100%\",\n};\n\ntype Style = Record<string, any>;\n\nexport function generateContainerStyle(\n  layout: string,\n  width: number,\n  height: number,\n  backgroundColor?: string,\n  userStyle?: Record<string, any>\n): Style {\n  return {\n    position: \"relative\",\n    overflow: \"hidden\",\n\n    // fill layout: 容器使用绝对定位并撑满父元素\n    ...(layout === \"fill\" && {\n      position: \"absolute\",\n      ...insetStyle,\n    }),\n    // intrinsic layout: 容器宽度不超过图片实际宽度\n    ...(layout === \"intrinsic\" && {\n      maxWidth: width + \"px\",\n    }),\n    // responsive layout: 容器宽度自动拉伸\n    ...(layout === \"responsive\" && {}),\n    // fixed layout：容器宽度等于图片宽度\n    ...(layout === \"fixed\" && {\n      width: width + \"px\",\n      height: height + \"px\",\n    }),\n    // 用户提供的背景色\n    backgroundColor: backgroundColor,\n    // 添加用户提供的其他样式\n    ...userStyle,\n  };\n}\n\nexport function generatePlaceholderStyle(\n  objectFit?: string,\n  objectPosition?: string,\n  userStyle?: Record<string, any>\n): Style {\n  return {\n    display: \"block\",\n    position: \"absolute\",\n    // 模糊处理\n    filter: `blur(${PLACEHOLDER_BLURRED}px)`,\n    // 修复模糊滤镜导致的边缘模糊\n    transform: `scale(1.1)`,\n    objectFit,\n    objectPosition,\n    // 占位图撑满容器\n    ...insetStyle,\n    ...userStyle,\n  };\n}\n\nexport function generateImageStyle(\n  objectFit?: string,\n  objectPosition?: string,\n  userStyle?: Record<string, any>\n): Style {\n  return {\n    display: \"block\",\n    position: \"absolute\",\n    ...insetStyle,\n    objectFit,\n    objectPosition,\n    ...userStyle,\n  };\n}\n","export type ImageUrlGeneratorOptions = {\n  width?: number;\n  quality?: number;\n  format?: string;\n  secret?: string;\n  base?: string;\n};\n\nconst PUBLIC_BASE_URL_CI = \"https://cia.sec.miui.com\";\nconst PUBLIC_BASE_URL = \"https://cdna.sec.miui.com\";\nconst PRIVATE_BASE_URL = \"https://a.sec.miui.com\";\n\n/** 生成图像处理链接参数 */\nexport function genQueryString(options: ImageUrlGeneratorOptions) {\n  const searchParams = new URLSearchParams();\n\n  const { width = 0, quality = 0, format = \"\" } = options;\n\n  if (width) {\n    searchParams.append(\"width\", width.toFixed(0));\n  }\n\n  if (format) {\n    searchParams.append(\"format\", format);\n  }\n\n  if (quality) {\n    searchParams.append(\"quality\", quality.toFixed(0));\n  }\n\n  return searchParams.toString();\n}\n\n/** 生成图像处理链接参数 (万象) */\nexport function genQueryStringCI(options: ImageUrlGeneratorOptions) {\n  let query = \"\";\n\n  const { width = 0, quality = 0, format = \"\" } = options;\n\n  if (width) {\n    query += `/thumbnail/${width}x`;\n  }\n\n  if (quality) {\n    query += `/quality/${quality}`;\n  }\n\n  if (format) {\n    query += `/format/${format}`;\n  }\n\n  if (query) {\n    query = `imageMogr2` + query;\n  }\n\n  return query;\n}\n\nexport function generateImageUrl(\n  path: string,\n  options: ImageUrlGeneratorOptions = {}\n) {\n  const isSvg = path.split(\".\").pop() === \"svg\";\n\n  let base = options.base;\n  let query = \"\";\n\n  if (!base) {\n    base = options.secret ? PRIVATE_BASE_URL : PUBLIC_BASE_URL_CI;\n  }\n\n  if (options.secret) {\n    query = `secret=${options.secret}`;\n  }\n\n  const url = new URL(path, base);\n\n  if (isSvg) {\n    // Ignore SVG 直接返回图片\n  }\n  // 采用默认的参数生成方法\n  else if (base === PRIVATE_BASE_URL || base === PUBLIC_BASE_URL) {\n    query = resolveQueryString(query, genQueryString(options));\n  }\n  // 采用万象参数生成方法\n  else if (base === PUBLIC_BASE_URL_CI) {\n    query = resolveQueryString(query, genQueryStringCI(options));\n  }\n\n  return url.toString() + (query ? \"?\" + query : \"\");\n}\n\nlet SUPPORT_WEBP: boolean | null = null;\n\nexport function getWebpSupport() {\n  if (SUPPORT_WEBP === null) {\n    const canvas = document.createElement(\"canvas\");\n    if (!!(canvas.getContext && canvas.getContext(\"2d\"))) {\n      // was able or not to get WebP representation\n      SUPPORT_WEBP =\n        canvas.toDataURL(\"image/webp\").indexOf(\"data:image/webp\") == 0;\n    } else {\n      // very old browser like IE 8, canvas not supported\n      SUPPORT_WEBP = false;\n    }\n  }\n  return SUPPORT_WEBP;\n}\n\nexport function merge<T>(...obj: Record<string, any>[]): T {\n  const result: Record<string, any> = {};\n  obj.forEach((item) => {\n    Object.entries(item).forEach(([key, value]) => {\n      if (value !== undefined) {\n        result[key] = value;\n      }\n    });\n  });\n  return result as T;\n}\n\nexport function resolveQueryString(...params: string[]) {\n  let base = params[0];\n  for (let i = 1; i < params.length; i++) {\n    const cur = params[i];\n    if (cur) {\n      base = (base ? `${base}&` : \"\") + params[i];\n    }\n  }\n  return base;\n}\n","import { RefObject, useEffect } from \"react\";\ntype ElementRef = RefObject<Element | undefined>;\ntype CallbackFunction = (\n  entry: IntersectionObserverEntry,\n  observer: IntersectionObserver\n) => void;\n\ndeclare global {\n  interface Element {\n    _intersectionHandler?: CallbackFunction;\n  }\n}\n\nlet observer: IntersectionObserver | null = null;\n\nexport default function useIntersectionObserver(\n  elementRef: ElementRef,\n  callback: CallbackFunction\n) {\n  useEffect(() => {\n    if (!observer && window.IntersectionObserver) {\n      observer = new IntersectionObserver(\n        (entries: any[], observer) => {\n          entries.forEach((entry) => {\n            const target = entry.target as Element;\n            target?._intersectionHandler?.(entry, observer);\n          });\n        },\n        {\n          rootMargin: \"10%\",\n        }\n      );\n    }\n\n    if (observer && elementRef.current) {\n      elementRef.current._intersectionHandler = callback;\n      observer.observe(elementRef.current);\n    }\n\n    return () => {\n      if (observer && elementRef.current) {\n        observer.unobserve(elementRef.current);\n      }\n    };\n  }, []);\n}\n","import { AssetImageProps } from \"./AssetImage\";\nimport { useContext } from \"react\";\nimport { ConfigContext, ConfigProviderProps } from \"./ConfigProvider\";\nimport { merge } from \"../../shared\";\n\nconst defaultConfig: ConfigProviderProps = {\n  quality: 80,\n  sizeStep: 100,\n  objectPosition: \"center\",\n  objectFit: \"cover\",\n  animation: true,\n  lazy: true,\n};\n\nexport function useProps(componentProps?: AssetImageProps): AssetImageProps {\n  // 读取全局配置\n  const globalConfig = useContext(ConfigContext);\n\n  // 显式配置的组件属性 > 全局属性配置 > 属性默认值\n  return merge(defaultConfig, globalConfig, componentProps || {});\n}\n","import React, { CSSProperties } from \"react\";\n\nexport interface ConfigProviderProps {\n  baseUrl?: string;\n  secretToken?: string;\n  quality?: number;\n  sizeStep?: number;\n  backgroundColor?: string;\n  placeholder?: string;\n  objectPosition?: string;\n  objectFit?: CSSProperties[\"objectFit\"];\n  lazy?: boolean;\n  className?: string;\n  style?: CSSProperties;\n  animation?: boolean;\n  imageClassName?: string;\n  imageStyle?: CSSProperties;\n}\n\nexport const ConfigContext = React.createContext<ConfigProviderProps>({});\n\nexport const ConfigProvider: React.FunctionComponent<ConfigProviderProps> = ({\n  children,\n  ...config\n}) => {\n  return (\n    <ConfigContext.Provider value={config}>{children}</ConfigContext.Provider>\n  );\n};\n","import { useEffect, useState } from \"react\";\nimport {\n  generateImageUrl,\n  getWebpSupport,\n  ImageUrlGeneratorOptions,\n} from \"../../shared\";\nimport { useProps } from \"./use-props\";\n\nexport function useImageUrlGenerator() {\n  const props = useProps();\n  const [generator, setGenerator] = useState<typeof generateImageUrl | null>(\n    null\n  );\n\n  useEffect(() => {\n    const isSupportWebp = getWebpSupport();\n    setGenerator(() => {\n      return (path: string, options: ImageUrlGeneratorOptions = {}) => {\n        const {\n          quality = props.quality,\n          format = isSupportWebp ? \"webp\" : undefined,\n          secret = props.secretToken,\n          base = props.baseUrl,\n          width = 0,\n        } = options;\n\n        return generateImageUrl(path, {\n          width,\n          quality,\n          format,\n          secret,\n          base,\n        });\n      };\n    });\n  }, []);\n\n  return generator;\n}\n","import { useCallback, useEffect, useRef } from \"react\";\n\nexport function useDebounceFunction<T extends (...args: any) => any>(\n  func: T,\n  wait: number,\n  immediate = false\n) {\n  const timerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const immediateRef = useRef(immediate);\n\n  const callback = useCallback(\n    (...args: Parameters<T>) => {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n      if (wait <= 0) {\n        func.apply(undefined, args);\n      }\n\n      if (immediateRef.current) {\n        func.apply(undefined, args);\n        immediateRef.current = false;\n      }\n\n      timerRef.current = setTimeout(() => func.apply(undefined, args), wait);\n    },\n    [wait, immediate]\n  );\n\n  useEffect(() => {\n    return () => {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n    };\n  }, []);\n\n  return callback;\n}\n"],"mappings":"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","names":[]}