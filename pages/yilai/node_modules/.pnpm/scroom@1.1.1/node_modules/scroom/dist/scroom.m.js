import e from"emittery";import t from"resize-observer-polyfill";import n from"randomcolor";function i(e,t,n){if(void 0===n&&(n=1),n<=0)return[e];var i=Array(Math.ceil((t-e)/n)).fill(e).map(function(e,t){return e+t*n});return i[i.length-1]!==t&&i.push(t),i}function r(e,t,n){return Math.abs(t-e)<Math.abs(n-e)?t:n}function o(n){var o=n.target,d=n.offset,s=void 0===d?.5:d,l=n.threshold,c=void 0===l?4:l,a=n.direction,p=void 0===a?"vertical":a,h=new e,f=v(),g=new t(u);function v(){var e,t;if("vertical"===p)e=-s*window.innerHeight+"px 0px "+((s-1)*window.innerHeight+o.clientHeight)+"px 0px",t=c/o.clientHeight;else{var n=-s*window.innerWidth;e="0px "+((s-1)*window.innerWidth+o.clientWidth)+"px 0px "+n+"px",t=c/o.clientWidth}var d=!1,l=-1,a=!0;return setTimeout(function(){a=!1}),new IntersectionObserver(function(e){var t=e[0],n=t.boundingClientRect,i=t.intersectionRect,c=t.isIntersecting,f=!1,g=0;"vertical"===p?(f=n.top<i.top&&c,g=1-i.height/n.height):"horizontal"===p&&(f=n.left<i.left&&c,g=1-i.width/n.width);var v=!d&&f,u=d&&!f;d=f;var x=function(e){l!==e&&h.emit("progress",{target:o,progress:e}),l=e};v&&(h.emit("enter",{target:o}),a||x(r(g,0,1))),f&&l!==g&&x(g),u&&(h.emit("leave",{target:o}),x(r(g,0,1))),h.emit("debug",{target:o,progress:g,offset:s,intersection:t,direction:p,action:v?"enter":u?"leave":f?"progress":null})},{rootMargin:e,threshold:i(0,1,t)})}function u(){f.disconnect(),(f=v()).observe(o)}return window.addEventListener("resize",u),g.observe(o),{target:o,observer:f,destroy:function(){f.disconnect(),g.disconnect(),h.clearListeners(),window.removeEventListener("resize",u)},on:h.on.bind(h),once:h.once.bind(h),off:h.off.bind(h)}}function d(e,t){var i=n({luminosity:"dark",format:"rgbArray"}),r="rgb("+i[0]+","+i[1]+","+i[2]+")",o="rgba("+i[0]+","+i[1]+","+i[2]+",0.1)",d=document.createElement("div"),s=document.createElement("div");function l(e){var n=e.offset,i=e.action,o=e.progress,l=e.intersection,c="enter"===i||"progress"===i?"block":"none";d.style.cssText="\n      position: fixed;\n      z-index: 99999;\n      pointer-events: none;\n      display: "+c+";\n      "+("vertical"===e.direction?"\n              left: 0;\n              width: 100%;\n              bottom: "+100*(1-n)+"%;\n              color: "+r+";\n              border-bottom: 1px dashed "+r+";\n              padding: 5px 20px;\n            ":"\n              top: 0;\n              height: 100%;\n              right: "+100*(1-n)+"%;\n              color: "+r+";\n              border-right: 1px dashed "+r+";\n              padding: 20px 5px;\n            ")+"\n    ",s.style.display=c;var a=l.boundingClientRect;s.style.top=a.top+"px",s.style.left=a.left+"px",s.style.width=a.width+"px",s.style.height=a.height+"px",c&&(d.innerText=(t?"["+t+"]":"")+"  "+(100*o).toFixed(3)+"%")}function c(){var t=e.target.getBoundingClientRect();s.style.top=t.top+"px",s.style.left=t.left+"px",s.style.width=t.width+"px",s.style.height=t.height+"px"}return s.style.cssText="\n      position: fixed;\n      z-index: 100000;\n      background: "+o+";\n      outline: 1px solid "+r+";\n      pointer-events: none;\n    ",document.body.appendChild(d),document.body.appendChild(s),e.on("debug",l),window.addEventListener("resize",c,!1),window.addEventListener("scroll",c,!1),c(),{destroy:function(){e.off("debug",l),window.removeEventListener("resize",c,!1),window.removeEventListener("scroll",c,!1),d.remove(),s.remove()}}}export{o as createScroom,d as debug};
//# sourceMappingURL=scroom.m.js.map
